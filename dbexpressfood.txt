/*Création de la base de donnée avec configuration de l'encodage utilisé.*/
CREATE DATABASE expressfood CHARACTER SET 'utf8';

/*sélection de la bdd*/
USE expressfood;

/*Création des tables sous le moteur INNODB pour gérer les clefs étrangères*/

/* table categorie */

/* table status_livreur*/

/*table adresse */
CREATE TABLE adresse
(
	adresse_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	adresse1 VARCHAR(40) NOT NULL,
	adresse2 VARCHAR(40) NOT NULL,
	code_postal INT UNSIGNED NOT NULL,
	ville VARCHAR(40) NOT NULL,
	pays VARCHAR(40) NOT NULL,
	telephone VARCHAR(40) NOT NULL,
	PRIMARY KEY (adresse_id)
)	
ENGINE=INNODB;

/*table utilisateur*/
CREATE TABLE utilisateur
(
	id INT UNSIGNED NOT NULL AUTO_INCREMENT,
	nom VARCHAR(40) NOT NULL,
	prenom VARCHAR(40) NOT NULL,
	adresse_utilisateur INT UNSIGNED NOT NULL,
	pseudo VARCHAR(40) NOT NULL,
	email VARCHAR(40) NOT NULL,
	motdepasse VARCHAR(40) NOT NULL,
	categorie_id INT UNSIGNED NOT NULL,
	PRIMARY KEY (id),
	UNIQUE ind_email (email),
	CONSTRAINT fk_adresse_adresse_id
		FOREIGN KEY(adresse_utilisateur)
		REFERENCES adresse(adresse_id)
)	
ENGINE=INNODB;

/*table livreur*/
CREATE TABLE livreur
(
    livreur_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    nom VARCHAR(40) NOT NULL,
    prenom VARCHAR(40) NOT NULL,
    statut CHAR(10) NOT NULL,
    position_actuelle VARCHAR(100) NOT NULL,
    PRIMARY KEY (livreur_id)
)
ENGINE=INNODB;

/* table plat */
CREATE TABLE plat
(
    plat_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    date_creation DATE NOT NULL,
    nom VARCHAR(40) NOT NULL,
    type_plat VARCHAR(40) NOT NULL,
    prix DECIMAL(6,2) NOT NULL,
    PRIMARY KEY (plat_id)
)
ENGINE=INNODB;

/* table sac*/
CREATE TABLE sac
(
    sac_livreur_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    plat INT UNSIGNED NOT NULL,
    livreur INT UNSIGNED NOT NULL,
    quantite INT NOT NULL,
    PRIMARY KEY (sac_livreur_id)
)
ENGINE=INNODB;

